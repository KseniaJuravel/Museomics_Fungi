% This file was produced by plot-vcfstats, the command line was:
%   plot-vcfstats joined_T4_054_vs_053.stats.txt -p corrected_outdir_T4
%
% Edit as necessary and recreate the PDF by running
%   pdflatex summary.tex
%

% Slides style and dimensions
%
\nonstopmode
\documentclass[17pt]{memoir}
\setstocksize{19cm}{25.4cm}
\settrimmedsize{\stockheight}{\stockwidth}{*}
\settrims{0pt}{0pt}
\setlrmarginsandblock{1cm}{*}{*}
\setulmarginsandblock{1.5cm}{*}{*}
\setheadfoot{1mm}{1cm}
\setlength{\parskip}{0pt}
\setheaderspaces{*}{1mm}{*}
\setmarginnotes{1mm}{1mm}{1mm}
\checkandfixthelayout[fixed]
\usepackage{charter}   % font
\pagestyle{plain}
\makeevenfoot{plain}{}{}{\thepage}
\makeoddfoot{plain}{}{}{\thepage}
\usepackage{graphicx}

% For colored tables. If xcolor.sty is not available on your system,
% download xcolor.sty.gz LaTeX class style from
%   http://www.ukern.de/tex/xcolor.html
% Unpack and install system-wide or place elsewhere and make available by
% setting the TEXINPUTS environment variable (note the colon)
%   export TEXINPUTS=some/dir:
% The list of the recognised path can be obtained by running `kpsepath tex`
%
\usepackage{multirow}
\setlength{\tabcolsep}{0.6em}
\renewcommand{\arraystretch}{1.2}
        
\usepackage[table]{xcolor}
\definecolor{hcol1}{rgb}{1,0.6,0}
\definecolor{hcol2}{rgb}{1,0.68,0.2}
\definecolor{row1}{rgb}{1,0.88,0.7}
\definecolor{row2}{rgb}{1,0.92,0.8}    % #FFEBCC
\setlength{\arrayrulewidth}{1.5pt}

% Slide headings
\newcommand*{\head}[1]{{\Large\centerline{#1}\vskip0.5em}}

% Slide definition
\newcommand*{\hslide}[2]{%
        \head{#1}%
        \begin{vplace}[0.5]\centerline{#2}\end{vplace}\newpage}
\newcommand{\pdf}[2]{\IfFileExists{#2}{\includegraphics[#1]{#2}}{}}


% The actual slides
\begin{document}
        
% Table with summary numbers
%
\hslide{Summary Numbers}{
\begin{minipage}{\textwidth}\centering
\small \rowcolors*{3}{row2}{row1} \arrayrulecolor{black}
\begin{tabular}{l | r r r | r r | r | r}
\multicolumn{1}{>{\columncolor{hcol1}}l|}{}
& \multicolumn{3}{>{\columncolor{hcol1}}c|}{SNPs}
& \multicolumn{2}{>{\columncolor{hcol1}}c|}{indels}
& \multicolumn{1}{>{\columncolor{hcol1}}c|}{MNPs}
& \multicolumn{1}{>{\columncolor{hcol1}}c}{others}  \\
%
\multicolumn{1}{>{\columncolor{hcol2}}l|}{Callset}
& \multicolumn{1}{>{\columncolor{hcol2}}c}{n}
& \multicolumn{1}{>{\columncolor{hcol2}}c }{ts/tv}
& \multicolumn{1}{>{\columncolor{hcol2}}c|}{\footnotesize(1st ALT)}
& \multicolumn{1}{>{\columncolor{hcol2}}c}{n}
& \multicolumn{1}{>{\columncolor{hcol2}}c}{frm$^*$}
& \multicolumn{1}{>{\columncolor{hcol2}}c|}{}
& \multicolumn{1}{>{\columncolor{hcol2}}c}{} \\ \hline
         054\_T & 23,433 & 2.72 & 2.72 & 1,814 & -- & 0 & 0 \\ 
 poole & 1,496 & 1.99 & 2.00 & 397 & -- & 0 & 0 \\ 
 054\_T + poole & 65,998 & 3.00 & 3.00 & 2,936 & -- & 0 & 0 \\ 
%
        \multicolumn{8}{r}{$^*$ frameshift ratio: out/(out+in)} \\
        \end{tabular}
        \\ \vspace{1em}
        \begin{tabular}{l | r r r | r r}
        \multicolumn{1}{>{\columncolor{hcol1}}l|}{}
        & \multicolumn{3}{>{\columncolor{hcol1}}c|}{singletons {\footnotesize(AC=1)}}
        & \multicolumn{2}{>{\columncolor{hcol1}}c}{multiallelic}  \\
        %
        \multicolumn{1}{>{\columncolor{hcol2}}l|}{Callset}
        & \multicolumn{1}{>{\columncolor{hcol2}}c}{SNPs}
        & \multicolumn{1}{>{\columncolor{hcol2}}c}{ts/tv}
        & \multicolumn{1}{>{\columncolor{hcol2}}c}{indels}
        & \multicolumn{1}{>{\columncolor{hcol2}}c}{sites}
        & \multicolumn{1}{>{\columncolor{hcol2}}c}{SNPs} \\ \hline
     054\_T & 0.7\% & 0.69 & 8.5\% & 26 &0 \\ 
 poole & 10.4\% & 1.00 & 43.1\% & 20 &2 \\ 
 054\_T + poole & 0.1\% & 2.73 & 1.9\% & 6 &0 \\ 
 \end{tabular}
\vspace{2em}
\begin{itemize}[-]
\setlength{\itemsep}{0pt}
        \item 054\_T .. \texttt{\footnotesize 054\_T4.g.vcf.gz.RGsorted.HaplotypeCaller.all.snp.filtered.vcf.gz.pass.vcf.gz}
\item poole .. \texttt{\footnotesize pooled.RGsorted.dedupped.HaplotypeCaller.all.snp.filtered.pass.vcf.gz}
\end{itemize}\end{minipage}}

        
%

            % Venn numbers
            %
            \hslide{Total counts}{%
                \includegraphics[width=10.5cm]{{venn_bars.snps}.png}%
                \includegraphics[width=10.5cm]{{venn_bars.indels}.png}
            }
        
% SNP and indel overlap by AF
%
\hslide{}{\vbox{\noindent\includegraphics[width=23cm]{{overlap_by_af.snps}.png}\\%
    \noindent\includegraphics[width=23cm]{{overlap_by_af.indels}.png}}}

% Ts/Tv stratified by QUAL
%
\hslide{Ts/Tv stratified by QUAL}{\includegraphics[width=8cm]{{tstv_by_qual.0}.png}\includegraphics[width=8cm]{{tstv_by_qual.1}.png}\includegraphics[width=8cm]{{tstv_by_qual.2}.png}}
        
% Indel distribution
%
\hslide{Indel distribution}{\includegraphics[width=8cm]{{indels.0}.png}\includegraphics[width=8cm]{{indels.1}.png}\includegraphics[width=8cm]{{indels.2}.png}}
        
% Depth distribution
%
\hslide{Depth distribution}{\includegraphics[width=8cm]{{depth.0}.png}\includegraphics[width=8cm]{{depth.1}.png}\includegraphics[width=8cm]{{depth.2}.png}}
        
% Substitution types
%
\hslide{Substitution types}{\includegraphics[width=8cm]{{substitutions.0}.png}\includegraphics[width=8cm]{{substitutions.1}.png}\includegraphics[width=8cm]{{substitutions.2}.png}}
        
\end{document}
